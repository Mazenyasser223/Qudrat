{"ast":null,"code":"import _objectSpread from\"M:/Qudrat/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useForm,useFieldArray}from'react-hook-form';import{useNavigate}from'react-router-dom';import axios from'axios';import toast from'react-hot-toast';import{Plus,Trash2,Upload,Save,ArrowLeft}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CreateExam=()=>{const navigate=useNavigate();const[uploading,setUploading]=useState(false);const[submitting,setSubmitting]=useState(false);const[showMultipleUpload,setShowMultipleUpload]=useState(false);const[existingExams,setExistingExams]=useState([]);const{register,control,handleSubmit,formState:{errors},setValue,watch}=useForm({defaultValues:{title:'',description:'',examGroup:1,order:1,timeLimit:60,questions:[{questionImage:'',correctAnswer:'A',explanation:''}]}});// Watch for examGroup changes to update order\nconst watchedGroup=watch('examGroup');useEffect(()=>{if(existingExams.length>0){const nextOrder=getNextAvailableOrder(watchedGroup);setValue('order',nextOrder);}},[watchedGroup,existingExams,setValue]);const{fields,append,remove}=useFieldArray({control,name:'questions'});// Fetch existing exams to suggest next available order\nuseEffect(()=>{const fetchExistingExams=async()=>{try{const response=await axios.get('/api/exams',{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});setExistingExams(response.data.data);}catch(error){console.error('Error fetching existing exams:',error);}};fetchExistingExams();},[]);// Function to get next available order for a group\nconst getNextAvailableOrder=group=>{const groupExams=existingExams.filter(exam=>exam.examGroup===group);if(groupExams.length===0)return 1;const maxOrder=Math.max(...groupExams.map(exam=>exam.order));return maxOrder+1;};const onSubmit=async data=>{try{setSubmitting(true);// Send exam data as JSON (images are already Base64 in data.questions)\nconst examData={title:data.title,description:data.description,examGroup:parseInt(data.examGroup),order:parseInt(data.order),timeLimit:parseInt(data.timeLimit),questions:data.questions};await axios.post('/api/exams',examData,{headers:{'Content-Type':'application/json'},timeout:45000// 45 seconds for large exams\n});toast.success('تم إنشاء الامتحان بنجاح');navigate('/teacher/exams');}catch(error){var _error$response,_error$response$data;console.error('Error creating exam:',error);if((_error$response=error.response)!==null&&_error$response!==void 0&&(_error$response$data=_error$response.data)!==null&&_error$response$data!==void 0&&_error$response$data.errors){// Display validation errors\nerror.response.data.errors.forEach(err=>{toast.error(err.msg);});}else{var _error$response2,_error$response2$data;toast.error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'حدث خطأ أثناء إنشاء الامتحان');}}finally{setSubmitting(false);}};const handleImageUpload=async(event,questionIndex)=>{const file=event.target.files[0];if(!file)return;// Validate file type\nif(!file.type.startsWith('image/')){toast.error('يرجى اختيار ملف صورة صحيح');return;}// Validate file size (5MB limit)\nif(file.size>5*1024*1024){toast.error('حجم الصورة يجب أن يكون أقل من 5 ميجابايت');return;}try{setUploading(true);// Convert file to Base64\nconst reader=new FileReader();reader.onload=async e=>{try{const imageData=e.target.result;// Upload the image as Base64\nconst response=await axios.post('/api/exams/upload-image',{imageData},{headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});// Set the uploaded image URL (Base64 data)\nconst imageUrl=response.data.imageUrl;console.log('Uploaded image URL:',imageUrl);setValue(\"questions.\".concat(questionIndex,\".questionImage\"),imageUrl);toast.success('تم رفع الصورة بنجاح');}catch(error){console.error('Error uploading image:',error);if(error.response){toast.error(\"\\u062D\\u062F\\u062B \\u062E\\u0637\\u0623 \\u0623\\u062B\\u0646\\u0627\\u0621 \\u0631\\u0641\\u0639 \\u0627\\u0644\\u0635\\u0648\\u0631\\u0629: \".concat(error.response.data.message||'خطأ غير معروف'));}else{toast.error('حدث خطأ أثناء رفع الصورة');}}finally{setUploading(false);}};reader.readAsDataURL(file);}catch(error){console.error('Error reading file:',error);toast.error('حدث خطأ أثناء قراءة الملف');setUploading(false);}};const handleMultipleImageUpload=async event=>{const files=Array.from(event.target.files);if(files.length===0)return;// Validate all files\nfor(const file of files){if(!file.type.startsWith('image/')){toast.error(\"\\u0627\\u0644\\u0645\\u0644\\u0641 \".concat(file.name,\" \\u0644\\u064A\\u0633 \\u0635\\u0648\\u0631\\u0629 \\u0635\\u062D\\u064A\\u062D\\u0629\"));return;}if(file.size>5*1024*1024){toast.error(\"\\u062D\\u062C\\u0645 \\u0627\\u0644\\u0645\\u0644\\u0641 \".concat(file.name,\" \\u064A\\u062C\\u0628 \\u0623\\u0646 \\u064A\\u0643\\u0648\\u0646 \\u0623\\u0642\\u0644 \\u0645\\u0646 5 \\u0645\\u064A\\u062C\\u0627\\u0628\\u0627\\u064A\\u062A\"));return;}}try{setUploading(true);toast.loading(\"\\u062C\\u0627\\u0631\\u064A \\u0631\\u0641\\u0639 \".concat(files.length,\" \\u0635\\u0648\\u0631\\u0629...\"));// Upload all images as Base64\nconst uploadPromises=files.map(async file=>{return new Promise((resolve,reject)=>{const reader=new FileReader();reader.onload=async e=>{try{const imageData=e.target.result;const response=await axios.post('/api/exams/upload-image',{imageData},{headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});const imageUrl=response.data.imageUrl;console.log('Multiple upload image URL:',imageUrl);resolve(imageUrl);}catch(error){reject(error);}};reader.readAsDataURL(file);});});const uploadedUrls=await Promise.all(uploadPromises);// Create questions for each uploaded image\nconst newQuestions=uploadedUrls.map((imageUrl,index)=>({questionImage:imageUrl,correctAnswer:'A',explanation:''}));// Check if there's an existing empty question (the default one)\nconst currentQuestions=watch('questions');const hasEmptyQuestion=currentQuestions.length===1&&!currentQuestions[0].questionImage;if(hasEmptyQuestion){// Replace the empty question with the first uploaded image\nsetValue('questions.0.questionImage',uploadedUrls[0]);setValue('questions.0.correctAnswer','A');setValue('questions.0.explanation','');// Add the remaining questions\nfor(let i=1;i<newQuestions.length;i++){append(newQuestions[i]);}}else{// Add all new questions\nnewQuestions.forEach(question=>{append(question);});}toast.success(\"\\u062A\\u0645 \\u0631\\u0641\\u0639 \".concat(files.length,\" \\u0635\\u0648\\u0631\\u0629 \\u0628\\u0646\\u062C\\u0627\\u062D \\u0648\\u062A\\u0645 \\u0625\\u0646\\u0634\\u0627\\u0621 \").concat(files.length,\" \\u0633\\u0624\\u0627\\u0644\"));setShowMultipleUpload(false);// Clear the file input\nevent.target.value='';}catch(error){console.error('Error uploading multiple images:',error);toast.error('حدث خطأ أثناء رفع الصور');}finally{setUploading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 rtl:space-x-reverse\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate('/teacher/exams'),className:\"flex items-center space-x-2 rtl:space-x-reverse text-gray-600 hover:text-gray-800 transition-colors\",children:[/*#__PURE__*/_jsx(ArrowLeft,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0627\\u0644\\u0639\\u0648\\u062F\\u0629\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"\\u0625\\u0646\\u0634\\u0627\\u0621 \\u0627\\u0645\\u062A\\u062D\\u0627\\u0646 \\u062C\\u062F\\u064A\\u062F\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"\\u0623\\u0636\\u0641 \\u0627\\u0644\\u0623\\u0633\\u0626\\u0644\\u0629 \\u0648\\u0627\\u0644\\u0625\\u0639\\u062F\\u0627\\u062F\\u0627\\u062A \\u0644\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"})]})]})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"\\u0645\\u0639\\u0644\\u0648\\u0645\\u0627\\u062A \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646 \\u0627\\u0644\\u0623\\u0633\\u0627\\u0633\\u064A\\u0629\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u0639\\u0646\\u0648\\u0627\\u0646 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",className:\"input-field \".concat(errors.title?'border-red-500':''),placeholder:\"\\u0623\\u062F\\u062E\\u0644 \\u0639\\u0646\\u0648\\u0627\\u0646 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"},register('title',{required:'عنوان الامتحان مطلوب',minLength:{value:3,message:'العنوان يجب أن يكون 3 أحرف على الأقل'}}))),errors.title&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errors.title.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u0627\\u0644\\u0645\\u062C\\u0645\\u0648\\u0639\\u0629\"}),/*#__PURE__*/_jsxs(\"select\",_objectSpread(_objectSpread({className:\"input-field \".concat(errors.examGroup?'border-red-500':'')},register('examGroup',{required:'المجموعة مطلوبة',min:{value:0,message:'المجموعة يجب أن تكون 0 أو أكثر'},max:{value:8,message:'المجموعة يجب أن تكون 8 أو أقل'}})),{},{children:[/*#__PURE__*/_jsx(\"option\",{value:0,children:\"\\u0627\\u062E\\u062A\\u0628\\u0627\\u0631\\u0627\\u062A \\u0627\\u0644\\u062A\\u0623\\u0633\\u064A\\u0633\"}),Array.from({length:8},(_,i)=>i+1).map(num=>/*#__PURE__*/_jsxs(\"option\",{value:num,children:[\"\\u0627\\u0644\\u0645\\u062C\\u0645\\u0648\\u0639\\u0629 \",num]},num))]})),errors.examGroup&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errors.examGroup.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u062A\\u0631\\u062A\\u064A\\u0628 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646 \\u0641\\u064A \\u0627\\u0644\\u0645\\u062C\\u0645\\u0648\\u0639\\u0629\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"number\",min:\"1\",className:\"input-field \".concat(errors.order?'border-red-500':''),placeholder:\"1\"},register('order',{required:'ترتيب الامتحان مطلوب',min:{value:1,message:'الترتيب يجب أن يكون 1 أو أكثر'}}))),errors.order&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errors.order.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u0627\\u0644\\u0648\\u0642\\u062A \\u0627\\u0644\\u0645\\u062D\\u062F\\u062F (\\u0628\\u0627\\u0644\\u062F\\u0642\\u0627\\u0626\\u0642)\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"number\",min:\"1\",className:\"input-field \".concat(errors.timeLimit?'border-red-500':''),placeholder:\"60\"},register('timeLimit',{required:'الوقت المحدد مطلوب',min:{value:1,message:'الوقت يجب أن يكون دقيقة واحدة على الأقل'}}))),errors.timeLimit&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errors.timeLimit.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u0648\\u0635\\u0641 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646 (\\u0627\\u062E\\u062A\\u064A\\u0627\\u0631\\u064A)\"}),/*#__PURE__*/_jsx(\"textarea\",_objectSpread({className:\"input-field \".concat(errors.description?'border-red-500':''),rows:\"3\",placeholder:\"\\u0623\\u062F\\u062E\\u0644 \\u0648\\u0635\\u0641\\u0627\\u064B \\u0644\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"},register('description'))),errors.description&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errors.description.message})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"\\u0623\\u0633\\u0626\\u0644\\u0629 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 rtl:space-x-reverse\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setShowMultipleUpload(true),className:\"btn-secondary flex items-center space-x-2 rtl:space-x-reverse\",children:[/*#__PURE__*/_jsx(Upload,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0631\\u0641\\u0639 \\u0635\\u0648\\u0631 \\u0645\\u062A\\u0639\\u062F\\u062F\\u0629\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>append({questionImage:'',correctAnswer:'A',explanation:''}),className:\"btn-primary flex items-center space-x-2 rtl:space-x-reverse\",children:[/*#__PURE__*/_jsx(Plus,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0625\\u0636\\u0627\\u0641\\u0629 \\u0633\\u0624\\u0627\\u0644\"})]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:fields.map((field,index)=>{var _errors$questions,_errors$questions$ind,_errors$questions2,_errors$questions2$in;return/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-lg font-medium text-gray-900\",children:[\"\\u0627\\u0644\\u0633\\u0624\\u0627\\u0644 \",index+1]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>remove(index),className:\"text-red-600 hover:text-red-800 transition-colors p-1 rounded hover:bg-red-50\",title:\"\\u062D\\u0630\\u0641 \\u0627\\u0644\\u0633\\u0624\\u0627\\u0644\",children:/*#__PURE__*/_jsx(Trash2,{className:\"h-4 w-4\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u0635\\u0648\\u0631\\u0629 \\u0627\\u0644\\u0633\\u0624\\u0627\\u0644\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>handleImageUpload(e,index),className:\"input-field\",disabled:uploading}),uploading&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-2\",children:\"\\u062C\\u0627\\u0631\\u064A \\u0631\\u0641\\u0639 \\u0627\\u0644\\u0635\\u0648\\u0631\\u0629...\"})]}),watch(\"questions.\".concat(index,\".questionImage\"))&&!uploading&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 p-4 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300\",children:[/*#__PURE__*/_jsx(\"img\",{src:watch(\"questions.\".concat(index,\".questionImage\")),alt:\"Question \".concat(index+1),className:\"w-full h-auto rounded-lg border bg-white shadow-sm\",style:{maxHeight:'800px',maxWidth:'100%',objectFit:'contain',minHeight:'400px',width:'100%'},onError:e=>{console.error('Image load error:',e.target.src);console.error('Available image URL:',watch(\"questions.\".concat(index,\".questionImage\")));// Don't set fallback image, let it show broken image icon\n}}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-green-600 mt-2 text-center\",children:\"\\u2713 \\u062A\\u0645 \\u0631\\u0641\\u0639 \\u0627\\u0644\\u0635\\u0648\\u0631\\u0629 \\u0628\\u0646\\u062C\\u0627\\u062D\"})]})]}),((_errors$questions=errors.questions)===null||_errors$questions===void 0?void 0:(_errors$questions$ind=_errors$questions[index])===null||_errors$questions$ind===void 0?void 0:_errors$questions$ind.questionImage)&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errors.questions[index].questionImage.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u0627\\u0644\\u0625\\u062C\\u0627\\u0628\\u0629 \\u0627\\u0644\\u0635\\u062D\\u064A\\u062D\\u0629\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2\",children:['A','B','C','D'].map(choice=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center justify-center p-4 border-2 rounded-lg cursor-pointer transition-all duration-200 \".concat(watch(\"questions.\".concat(index,\".correctAnswer\"))===choice?'border-green-500 bg-green-50 text-green-700':'border-gray-300 bg-white hover:border-gray-400'),children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"radio\",value:choice},register(\"questions.\".concat(index,\".correctAnswer\"),{required:'الإجابة الصحيحة مطلوبة'})),{},{className:\"sr-only\"})),/*#__PURE__*/_jsxs(\"span\",{className:\"text-lg font-semibold\",children:[\"\\u0627\\u0644\\u062E\\u064A\\u0627\\u0631 \",choice]})]},choice))}),((_errors$questions2=errors.questions)===null||_errors$questions2===void 0?void 0:(_errors$questions2$in=_errors$questions2[index])===null||_errors$questions2$in===void 0?void 0:_errors$questions2$in.correctAnswer)&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message mt-2\",children:errors.questions[index].correctAnswer.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u062A\\u0648\\u0636\\u064A\\u062D \\u0627\\u0644\\u0625\\u062C\\u0627\\u0628\\u0629 (\\u0627\\u062E\\u062A\\u064A\\u0627\\u0631\\u064A)\"}),/*#__PURE__*/_jsx(\"textarea\",_objectSpread({className:\"input-field\",rows:\"2\",placeholder:\"\\u0623\\u062F\\u062E\\u0644 \\u062A\\u0648\\u0636\\u064A\\u062D\\u0627\\u064B \\u0644\\u0644\\u0625\\u062C\\u0627\\u0628\\u0629 \\u0627\\u0644\\u0635\\u062D\\u064A\\u062D\\u0629\"},register(\"questions.\".concat(index,\".explanation\"))))]})]},field.id);})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-4 rtl:space-x-reverse\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>navigate('/teacher/exams'),className:\"btn-secondary\",children:\"\\u0625\\u0644\\u063A\\u0627\\u0621\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:submitting,className:\"btn-primary flex items-center space-x-2 rtl:space-x-reverse\",children:submitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u062C\\u0627\\u0631\\u064A \\u0627\\u0644\\u062D\\u0641\\u0638...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Save,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0625\\u0646\\u0634\\u0627\\u0621 \\u0627\\u0644\\u0627\\u0645\\u062A\\u062D\\u0627\\u0646\"})]})})]})]}),showMultipleUpload&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-xl w-full max-w-md\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 text-white px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 rtl:space-x-reverse\",children:[/*#__PURE__*/_jsx(Upload,{className:\"h-6 w-6\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:\"\\u0631\\u0641\\u0639 \\u0635\\u0648\\u0631 \\u0645\\u062A\\u0639\\u062F\\u062F\\u0629\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-100 text-sm\",children:\"\\u0627\\u062E\\u062A\\u0631 \\u0639\\u062F\\u0629 \\u0635\\u0648\\u0631 \\u0644\\u0625\\u0646\\u0634\\u0627\\u0621 \\u0623\\u0633\\u0626\\u0644\\u0629 \\u0645\\u062A\\u0639\\u062F\\u062F\\u0629\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 transition-colors\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",multiple:true,accept:\"image/*\",onChange:handleMultipleImageUpload,className:\"hidden\",id:\"multiple-upload\",disabled:uploading}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"multiple-upload\",className:\"cursor-pointer\",children:[/*#__PURE__*/_jsx(Upload,{className:\"mx-auto h-12 w-12 text-gray-400 mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:uploading?'جاري الرفع...':'اختر صور متعددة'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"\\u064A\\u0645\\u0643\\u0646\\u0643 \\u0627\\u062E\\u062A\\u064A\\u0627\\u0631 \\u0639\\u062F\\u0629 \\u0635\\u0648\\u0631 \\u0641\\u064A \\u0646\\u0641\\u0633 \\u0627\\u0644\\u0648\\u0642\\u062A\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400 mt-2\",children:\"\\u0627\\u0644\\u062D\\u062F \\u0627\\u0644\\u0623\\u0642\\u0635\\u0649: 5 \\u0645\\u064A\\u062C\\u0627\\u0628\\u0627\\u064A\\u062A \\u0644\\u0643\\u0644 \\u0635\\u0648\\u0631\\u0629\"})]})]}),uploading&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner mx-auto mb-2\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"\\u062C\\u0627\\u0631\\u064A \\u0631\\u0641\\u0639 \\u0627\\u0644\\u0635\\u0648\\u0631...\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end space-x-3 rtl:space-x-reverse mt-6 pt-4 border-t border-gray-200\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowMultipleUpload(false);},className:\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors\",disabled:uploading,children:\"\\u0625\\u0644\\u063A\\u0627\\u0621\"})})]})]})})]});};export default CreateExam;","map":{"version":3,"names":["React","useState","useEffect","useForm","useFieldArray","useNavigate","axios","toast","Plus","Trash2","Upload","Save","ArrowLeft","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CreateExam","navigate","uploading","setUploading","submitting","setSubmitting","showMultipleUpload","setShowMultipleUpload","existingExams","setExistingExams","register","control","handleSubmit","formState","errors","setValue","watch","defaultValues","title","description","examGroup","order","timeLimit","questions","questionImage","correctAnswer","explanation","watchedGroup","length","nextOrder","getNextAvailableOrder","fields","append","remove","name","fetchExistingExams","response","get","headers","concat","localStorage","getItem","data","error","console","group","groupExams","filter","exam","maxOrder","Math","max","map","onSubmit","examData","parseInt","post","timeout","success","_error$response","_error$response$data","forEach","err","msg","_error$response2","_error$response2$data","message","handleImageUpload","event","questionIndex","file","target","files","type","startsWith","size","reader","FileReader","onload","e","imageData","result","imageUrl","log","readAsDataURL","handleMultipleImageUpload","Array","from","loading","uploadPromises","Promise","resolve","reject","uploadedUrls","all","newQuestions","index","currentQuestions","hasEmptyQuestion","i","question","value","className","children","onClick","_objectSpread","placeholder","required","minLength","min","_","num","rows","field","_errors$questions","_errors$questions$ind","_errors$questions2","_errors$questions2$in","accept","onChange","disabled","src","alt","style","maxHeight","maxWidth","objectFit","minHeight","width","onError","choice","id","multiple","htmlFor"],"sources":["M:/Qudrat/client/src/pages/Teacher/CreateExam.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useForm, useFieldArray } from 'react-hook-form';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\nimport { Plus, Trash2, Upload, Save, ArrowLeft } from 'lucide-react';\r\n\r\nconst CreateExam = () => {\r\n  const navigate = useNavigate();\r\n  const [uploading, setUploading] = useState(false);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [showMultipleUpload, setShowMultipleUpload] = useState(false);\r\n  const [existingExams, setExistingExams] = useState([]);\r\n\r\n  const {\r\n    register,\r\n    control,\r\n    handleSubmit,\r\n    formState: { errors },\r\n    setValue,\r\n    watch\r\n  } = useForm({\r\n    defaultValues: {\r\n      title: '',\r\n      description: '',\r\n      examGroup: 1,\r\n      order: 1,\r\n      timeLimit: 60,\r\n      questions: [\r\n        {\r\n          questionImage: '',\r\n          correctAnswer: 'A',\r\n          explanation: ''\r\n        }\r\n      ]\r\n    }\r\n  });\r\n\r\n  // Watch for examGroup changes to update order\r\n  const watchedGroup = watch('examGroup');\r\n  \r\n  useEffect(() => {\r\n    if (existingExams.length > 0) {\r\n      const nextOrder = getNextAvailableOrder(watchedGroup);\r\n      setValue('order', nextOrder);\r\n    }\r\n  }, [watchedGroup, existingExams, setValue]);\r\n\r\n  const { fields, append, remove } = useFieldArray({\r\n    control,\r\n    name: 'questions'\r\n  });\r\n\r\n  // Fetch existing exams to suggest next available order\r\n  useEffect(() => {\r\n    const fetchExistingExams = async () => {\r\n      try {\r\n        const response = await axios.get('/api/exams', {\r\n          headers: {\r\n            'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n          }\r\n        });\r\n        setExistingExams(response.data.data);\r\n      } catch (error) {\r\n        console.error('Error fetching existing exams:', error);\r\n      }\r\n    };\r\n    fetchExistingExams();\r\n  }, []);\r\n\r\n  // Function to get next available order for a group\r\n  const getNextAvailableOrder = (group) => {\r\n    const groupExams = existingExams.filter(exam => exam.examGroup === group);\r\n    if (groupExams.length === 0) return 1;\r\n    const maxOrder = Math.max(...groupExams.map(exam => exam.order));\r\n    return maxOrder + 1;\r\n  };\r\n\r\n  const onSubmit = async (data) => {\r\n    try {\r\n      setSubmitting(true);\r\n      \r\n      // Send exam data as JSON (images are already Base64 in data.questions)\r\n      const examData = {\r\n        title: data.title,\r\n        description: data.description,\r\n        examGroup: parseInt(data.examGroup),\r\n        order: parseInt(data.order),\r\n        timeLimit: parseInt(data.timeLimit),\r\n        questions: data.questions\r\n      };\r\n\r\n      await axios.post('/api/exams', examData, {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        timeout: 45000, // 45 seconds for large exams\r\n      });\r\n      \r\n      toast.success('تم إنشاء الامتحان بنجاح');\r\n      navigate('/teacher/exams');\r\n    } catch (error) {\r\n      console.error('Error creating exam:', error);\r\n      if (error.response?.data?.errors) {\r\n        // Display validation errors\r\n        error.response.data.errors.forEach(err => {\r\n          toast.error(err.msg);\r\n        });\r\n      } else {\r\n        toast.error(error.response?.data?.message || 'حدث خطأ أثناء إنشاء الامتحان');\r\n      }\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleImageUpload = async (event, questionIndex) => {\r\n    const file = event.target.files[0];\r\n    if (!file) return;\r\n\r\n    // Validate file type\r\n    if (!file.type.startsWith('image/')) {\r\n      toast.error('يرجى اختيار ملف صورة صحيح');\r\n      return;\r\n    }\r\n\r\n    // Validate file size (5MB limit)\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      toast.error('حجم الصورة يجب أن يكون أقل من 5 ميجابايت');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setUploading(true);\r\n      \r\n      // Convert file to Base64\r\n      const reader = new FileReader();\r\n      reader.onload = async (e) => {\r\n        try {\r\n          const imageData = e.target.result;\r\n          \r\n          // Upload the image as Base64\r\n          const response = await axios.post('/api/exams/upload-image', \r\n            { imageData }, \r\n            {\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `Bearer ${localStorage.getItem('token')}`,\r\n              },\r\n            }\r\n          );\r\n          \r\n          // Set the uploaded image URL (Base64 data)\r\n          const imageUrl = response.data.imageUrl;\r\n          console.log('Uploaded image URL:', imageUrl);\r\n          setValue(`questions.${questionIndex}.questionImage`, imageUrl);\r\n          \r\n          toast.success('تم رفع الصورة بنجاح');\r\n        } catch (error) {\r\n          console.error('Error uploading image:', error);\r\n          if (error.response) {\r\n            toast.error(`حدث خطأ أثناء رفع الصورة: ${error.response.data.message || 'خطأ غير معروف'}`);\r\n          } else {\r\n            toast.error('حدث خطأ أثناء رفع الصورة');\r\n          }\r\n        } finally {\r\n          setUploading(false);\r\n        }\r\n      };\r\n      \r\n      reader.readAsDataURL(file);\r\n    } catch (error) {\r\n      console.error('Error reading file:', error);\r\n      toast.error('حدث خطأ أثناء قراءة الملف');\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleMultipleImageUpload = async (event) => {\r\n    const files = Array.from(event.target.files);\r\n    if (files.length === 0) return;\r\n\r\n    // Validate all files\r\n    for (const file of files) {\r\n      if (!file.type.startsWith('image/')) {\r\n        toast.error(`الملف ${file.name} ليس صورة صحيحة`);\r\n        return;\r\n      }\r\n      if (file.size > 5 * 1024 * 1024) {\r\n        toast.error(`حجم الملف ${file.name} يجب أن يكون أقل من 5 ميجابايت`);\r\n        return;\r\n      }\r\n    }\r\n\r\n    try {\r\n      setUploading(true);\r\n      toast.loading(`جاري رفع ${files.length} صورة...`);\r\n\r\n      // Upload all images as Base64\r\n      const uploadPromises = files.map(async (file) => {\r\n        return new Promise((resolve, reject) => {\r\n          const reader = new FileReader();\r\n          reader.onload = async (e) => {\r\n            try {\r\n              const imageData = e.target.result;\r\n              \r\n              const response = await axios.post('/api/exams/upload-image', \r\n                { imageData }, \r\n                {\r\n                  headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${localStorage.getItem('token')}`,\r\n                  },\r\n                }\r\n              );\r\n              \r\n              const imageUrl = response.data.imageUrl;\r\n              console.log('Multiple upload image URL:', imageUrl);\r\n              resolve(imageUrl);\r\n            } catch (error) {\r\n              reject(error);\r\n            }\r\n          };\r\n          reader.readAsDataURL(file);\r\n        });\r\n      });\r\n\r\n      const uploadedUrls = await Promise.all(uploadPromises);\r\n\r\n      // Create questions for each uploaded image\r\n      const newQuestions = uploadedUrls.map((imageUrl, index) => ({\r\n        questionImage: imageUrl,\r\n        correctAnswer: 'A',\r\n        explanation: ''\r\n      }));\r\n\r\n      // Check if there's an existing empty question (the default one)\r\n      const currentQuestions = watch('questions');\r\n      const hasEmptyQuestion = currentQuestions.length === 1 && !currentQuestions[0].questionImage;\r\n\r\n      if (hasEmptyQuestion) {\r\n        // Replace the empty question with the first uploaded image\r\n        setValue('questions.0.questionImage', uploadedUrls[0]);\r\n        setValue('questions.0.correctAnswer', 'A');\r\n        setValue('questions.0.explanation', '');\r\n        \r\n        // Add the remaining questions\r\n        for (let i = 1; i < newQuestions.length; i++) {\r\n          append(newQuestions[i]);\r\n        }\r\n      } else {\r\n        // Add all new questions\r\n        newQuestions.forEach(question => {\r\n          append(question);\r\n        });\r\n      }\r\n\r\n      toast.success(`تم رفع ${files.length} صورة بنجاح وتم إنشاء ${files.length} سؤال`);\r\n      setShowMultipleUpload(false);\r\n      \r\n      // Clear the file input\r\n      event.target.value = '';\r\n    } catch (error) {\r\n      console.error('Error uploading multiple images:', error);\r\n      toast.error('حدث خطأ أثناء رفع الصور');\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center space-x-4 rtl:space-x-reverse\">\r\n          <button\r\n            onClick={() => navigate('/teacher/exams')}\r\n            className=\"flex items-center space-x-2 rtl:space-x-reverse text-gray-600 hover:text-gray-800 transition-colors\"\r\n          >\r\n            <ArrowLeft className=\"h-4 w-4\" />\r\n            <span>العودة</span>\r\n          </button>\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">إنشاء امتحان جديد</h1>\r\n            <p className=\"text-gray-600\">أضف الأسئلة والإعدادات للامتحان</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\r\n        {/* Exam Basic Info */}\r\n        <div className=\"card\">\r\n          <div className=\"card-header\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900\">معلومات الامتحان الأساسية</h3>\r\n          </div>\r\n          <div className=\"card-body\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"form-group\">\r\n                <label className=\"form-label\">عنوان الامتحان</label>\r\n                <input\r\n                  type=\"text\"\r\n                  className={`input-field ${errors.title ? 'border-red-500' : ''}`}\r\n                  placeholder=\"أدخل عنوان الامتحان\"\r\n                  {...register('title', {\r\n                    required: 'عنوان الامتحان مطلوب',\r\n                    minLength: {\r\n                      value: 3,\r\n                      message: 'العنوان يجب أن يكون 3 أحرف على الأقل'\r\n                    }\r\n                  })}\r\n                />\r\n                {errors.title && (\r\n                  <p className=\"error-message\">{errors.title.message}</p>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label className=\"form-label\">المجموعة</label>\r\n                <select\r\n                  className={`input-field ${errors.examGroup ? 'border-red-500' : ''}`}\r\n                  {...register('examGroup', {\r\n                    required: 'المجموعة مطلوبة',\r\n                    min: { value: 0, message: 'المجموعة يجب أن تكون 0 أو أكثر' },\r\n                    max: { value: 8, message: 'المجموعة يجب أن تكون 8 أو أقل' }\r\n                  })}\r\n                >\r\n                  <option value={0}>اختبارات التأسيس</option>\r\n                  {Array.from({ length: 8 }, (_, i) => i + 1).map(num => (\r\n                    <option key={num} value={num}>المجموعة {num}</option>\r\n                  ))}\r\n                </select>\r\n                {errors.examGroup && (\r\n                  <p className=\"error-message\">{errors.examGroup.message}</p>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label className=\"form-label\">ترتيب الامتحان في المجموعة</label>\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  className={`input-field ${errors.order ? 'border-red-500' : ''}`}\r\n                  placeholder=\"1\"\r\n                  {...register('order', {\r\n                    required: 'ترتيب الامتحان مطلوب',\r\n                    min: { value: 1, message: 'الترتيب يجب أن يكون 1 أو أكثر' }\r\n                  })}\r\n                />\r\n                {errors.order && (\r\n                  <p className=\"error-message\">{errors.order.message}</p>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label className=\"form-label\">الوقت المحدد (بالدقائق)</label>\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  className={`input-field ${errors.timeLimit ? 'border-red-500' : ''}`}\r\n                  placeholder=\"60\"\r\n                  {...register('timeLimit', {\r\n                    required: 'الوقت المحدد مطلوب',\r\n                    min: { value: 1, message: 'الوقت يجب أن يكون دقيقة واحدة على الأقل' }\r\n                  })}\r\n                />\r\n                {errors.timeLimit && (\r\n                  <p className=\"error-message\">{errors.timeLimit.message}</p>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label className=\"form-label\">وصف الامتحان (اختياري)</label>\r\n              <textarea\r\n                className={`input-field ${errors.description ? 'border-red-500' : ''}`}\r\n                rows=\"3\"\r\n                placeholder=\"أدخل وصفاً للامتحان\"\r\n                {...register('description')}\r\n              />\r\n              {errors.description && (\r\n                <p className=\"error-message\">{errors.description.message}</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Questions */}\r\n        <div className=\"card\">\r\n          <div className=\"card-header\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">أسئلة الامتحان</h3>\r\n              <div className=\"flex items-center space-x-3 rtl:space-x-reverse\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowMultipleUpload(true)}\r\n                  className=\"btn-secondary flex items-center space-x-2 rtl:space-x-reverse\"\r\n                >\r\n                  <Upload className=\"h-4 w-4\" />\r\n                  <span>رفع صور متعددة</span>\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => append({\r\n                    questionImage: '',\r\n                    correctAnswer: 'A',\r\n                    explanation: ''\r\n                  })}\r\n                  className=\"btn-primary flex items-center space-x-2 rtl:space-x-reverse\"\r\n                >\r\n                  <Plus className=\"h-4 w-4\" />\r\n                  <span>إضافة سؤال</span>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"card-body\">\r\n            <div className=\"space-y-6\">\r\n              {fields.map((field, index) => (\r\n                <div key={field.id} className=\"border border-gray-200 rounded-lg p-4\">\r\n                  <div className=\"flex items-center justify-between mb-4\">\r\n                    <h4 className=\"text-lg font-medium text-gray-900\">\r\n                      السؤال {index + 1}\r\n                    </h4>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => remove(index)}\r\n                      className=\"text-red-600 hover:text-red-800 transition-colors p-1 rounded hover:bg-red-50\"\r\n                      title=\"حذف السؤال\"\r\n                    >\r\n                      <Trash2 className=\"h-4 w-4\" />\r\n                    </button>\r\n                  </div>\r\n\r\n                  {/* Question Image - Full Width */}\r\n                  <div className=\"form-group\">\r\n                    <label className=\"form-label\">صورة السؤال</label>\r\n                    <div className=\"space-y-2\">\r\n                      <input\r\n                        type=\"file\"\r\n                        accept=\"image/*\"\r\n                        onChange={(e) => handleImageUpload(e, index)}\r\n                        className=\"input-field\"\r\n                        disabled={uploading}\r\n                      />\r\n                      {uploading && (\r\n                        <div className=\"mt-2 text-center\">\r\n                          <div className=\"spinner mx-auto\"></div>\r\n                          <p className=\"text-sm text-gray-600 mt-2\">جاري رفع الصورة...</p>\r\n                        </div>\r\n                      )}\r\n                      {watch(`questions.${index}.questionImage`) && !uploading && (\r\n                        <div className=\"mt-2 p-4 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300\">\r\n                          <img\r\n                            src={watch(`questions.${index}.questionImage`)}\r\n                            alt={`Question ${index + 1}`}\r\n                            className=\"w-full h-auto rounded-lg border bg-white shadow-sm\"\r\n                            style={{\r\n                              maxHeight: '800px',\r\n                              maxWidth: '100%',\r\n                              objectFit: 'contain',\r\n                              minHeight: '400px',\r\n                              width: '100%'\r\n                            }}\r\n                            onError={(e) => {\r\n                              console.error('Image load error:', e.target.src);\r\n                              console.error('Available image URL:', watch(`questions.${index}.questionImage`));\r\n                              // Don't set fallback image, let it show broken image icon\r\n                            }}\r\n                          />\r\n                          <p className=\"text-xs text-green-600 mt-2 text-center\">✓ تم رفع الصورة بنجاح</p>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    {errors.questions?.[index]?.questionImage && (\r\n                      <p className=\"error-message\">\r\n                        {errors.questions[index].questionImage.message}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Answer Choices - Below Photo */}\r\n                  <div className=\"form-group\">\r\n                    <label className=\"form-label\">الإجابة الصحيحة</label>\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2\">\r\n                      {['A', 'B', 'C', 'D'].map((choice) => (\r\n                        <label\r\n                          key={choice}\r\n                          className={`flex items-center justify-center p-4 border-2 rounded-lg cursor-pointer transition-all duration-200 ${\r\n                            watch(`questions.${index}.correctAnswer`) === choice\r\n                              ? 'border-green-500 bg-green-50 text-green-700'\r\n                              : 'border-gray-300 bg-white hover:border-gray-400'\r\n                          }`}\r\n                        >\r\n                          <input\r\n                            type=\"radio\"\r\n                            value={choice}\r\n                            {...register(`questions.${index}.correctAnswer`, {\r\n                              required: 'الإجابة الصحيحة مطلوبة'\r\n                            })}\r\n                            className=\"sr-only\"\r\n                          />\r\n                          <span className=\"text-lg font-semibold\">الخيار {choice}</span>\r\n                        </label>\r\n                      ))}\r\n                    </div>\r\n                    {errors.questions?.[index]?.correctAnswer && (\r\n                      <p className=\"error-message mt-2\">\r\n                        {errors.questions[index].correctAnswer.message}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Explanation */}\r\n                  <div className=\"form-group\">\r\n                    <label className=\"form-label\">توضيح الإجابة (اختياري)</label>\r\n                    <textarea\r\n                      className=\"input-field\"\r\n                      rows=\"2\"\r\n                      placeholder=\"أدخل توضيحاً للإجابة الصحيحة\"\r\n                      {...register(`questions.${index}.explanation`)}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Submit Button */}\r\n        <div className=\"flex justify-end space-x-4 rtl:space-x-reverse\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => navigate('/teacher/exams')}\r\n            className=\"btn-secondary\"\r\n          >\r\n            إلغاء\r\n          </button>\r\n          <button\r\n            type=\"submit\"\r\n            disabled={submitting}\r\n            className=\"btn-primary flex items-center space-x-2 rtl:space-x-reverse\"\r\n          >\r\n            {submitting ? (\r\n              <>\r\n                <div className=\"spinner\"></div>\r\n                <span>جاري الحفظ...</span>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Save className=\"h-4 w-4\" />\r\n                <span>إنشاء الامتحان</span>\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </form>\r\n\r\n      {/* Multiple Upload Modal */}\r\n      {showMultipleUpload && (\r\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4\">\r\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-md\">\r\n            <div className=\"bg-blue-600 text-white px-6 py-4\">\r\n              <div className=\"flex items-center space-x-3 rtl:space-x-reverse\">\r\n                <Upload className=\"h-6 w-6\" />\r\n                <div>\r\n                  <h3 className=\"text-lg font-semibold\">رفع صور متعددة</h3>\r\n                  <p className=\"text-blue-100 text-sm\">اختر عدة صور لإنشاء أسئلة متعددة</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"p-6\">\r\n              <div className=\"space-y-4\">\r\n                <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 transition-colors\">\r\n                  <input\r\n                    type=\"file\"\r\n                    multiple\r\n                    accept=\"image/*\"\r\n                    onChange={handleMultipleImageUpload}\r\n                    className=\"hidden\"\r\n                    id=\"multiple-upload\"\r\n                    disabled={uploading}\r\n                  />\r\n                  <label htmlFor=\"multiple-upload\" className=\"cursor-pointer\">\r\n                    <Upload className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\r\n                    <p className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                      {uploading ? 'جاري الرفع...' : 'اختر صور متعددة'}\r\n                    </p>\r\n                    <p className=\"text-sm text-gray-500\">\r\n                      يمكنك اختيار عدة صور في نفس الوقت\r\n                    </p>\r\n                    <p className=\"text-xs text-gray-400 mt-2\">\r\n                      الحد الأقصى: 5 ميجابايت لكل صورة\r\n                    </p>\r\n                  </label>\r\n                </div>\r\n                \r\n                {uploading && (\r\n                  <div className=\"text-center\">\r\n                    <div className=\"spinner mx-auto mb-2\"></div>\r\n                    <p className=\"text-sm text-gray-600\">جاري رفع الصور...</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              \r\n              <div className=\"flex justify-end space-x-3 rtl:space-x-reverse mt-6 pt-4 border-t border-gray-200\">\r\n                <button\r\n                  onClick={() => {\r\n                    setShowMultipleUpload(false);\r\n                  }}\r\n                  className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors\"\r\n                  disabled={uploading}\r\n                >\r\n                  إلغاء\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CreateExam;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}