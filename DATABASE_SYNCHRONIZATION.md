# ๐๏ธ ูุฒุงููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช - Database Synchronization

## โ **ูุนูุ ุฌููุน ุงูุนูููุงุช ุชุญุฏุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชููุงุฆูุงู!**

### ๐ **ุงูุนูููุงุช ุงูุชู ุชุชู ูุฒุงููุชูุง ุชููุงุฆูุงู:**

#### **1. ุฅุถุงูุฉ ุงูุชุญุงู ุฌุฏูุฏ:**
```javascript
// ุนูุฏ ุฅูุดุงุก ุงูุชุญุงู ุฌุฏูุฏ ููุนูู
POST /api/exams
```
**ูุง ูุญุฏุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
- โ **ุญูุธ ุงูุงูุชุญุงู** ูู ูุฌููุนุฉ `exams`
- โ **ุชุญุฏูุซ ุชูุฏู ุฌููุน ุงูุทูุงุจ** - ุฅุถุงูุฉ ุงูุงูุชุญุงู ุงูุฌุฏูุฏ ูุฌููุน ุงูุทูุงุจ
- โ **ุชุนููู ุญุงูุฉ "ูููู"** ููุงูุชุญุงู ุงูุฌุฏูุฏ
- โ **ุชุทุจูู ููุงุนุฏ ุงูุชุณูุณู** - ูุชุญ ุงูุงูุชุญุงู ุงูุชุงูู ุฅุฐุง ูุฒู ุงูุฃูุฑ

#### **2. ุญุฐู ุงูุชุญุงู:**
```javascript
// ุนูุฏ ุญุฐู ุงูุชุญุงู ููุนูู
DELETE /api/exams/:id
```
**ูุง ูุญุฏุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
- โ **ุญุฐู ุงูุงูุชุญุงู** ูู ูุฌููุนุฉ `exams`
- โ **ุชุญุฏูุซ ุชูุฏู ุฌููุน ุงูุทูุงุจ** - ุฅุฒุงูุฉ ุงูุงูุชุญุงู ูู ุชูุฏู ุงูุทูุงุจ
- โ **ุญุฐู ุงูุชุญุงูุงุช ุงููุฑุงุฌุนุฉ ุงููุฑุชุจุทุฉ** - ุฅุฐุง ูุงู ููุงู ุงูุชุญุงูุงุช ูุฑุงุฌุนุฉ
- โ **ุฅุนุงุฏุฉ ุชุฑุชูุจ ุงูุงูุชุญุงูุงุช** - ุชุญุฏูุซ ุญุงูุฉ ุงูุงูุชุญุงูุงุช ุงูุฃุฎุฑู

#### **3. ุญู ุงูุทุงูุจ ููุงูุชุญุงู:**
```javascript
// ุนูุฏ ุชุณููู ุงูุทุงูุจ ููุงูุชุญุงู
POST /api/exams/:id/submit
```
**ูุง ูุญุฏุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
- โ **ุญูุธ ุฅุฌุงุจุงุช ุงูุทุงูุจ** ูู `examProgress.answers`
- โ **ุญุณุงุจ ุงููุชูุฌุฉ ูุงููุณุจุฉ ุงููุฆููุฉ**
- โ **ุชุญุฏูุซ ุญุงูุฉ ุงูุงูุชุญุงู** ุฅูู "ููุชูู"
- โ **ุฌูุน ุงูุฃุณุฆูุฉ ุงูุฎุงุทุฆุฉ** ูู `wrongQuestions`
- โ **ุฅูุดุงุก ุงูุชุญุงู ูุฑุงุฌุนุฉ** ุฅุฐุง ูุงู ููุงู ุฃุณุฆูุฉ ุฎุงุทุฆุฉ
- โ **ูุชุญ ุงูุงูุชุญุงู ุงูุชุงูู** ุชููุงุฆูุงู
- โ **ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช ุงูุนุงูุฉ** ููุทุงูุจ

#### **4. ุญู ุงูุชุญุงู ุงููุฑุงุฌุนุฉ:**
```javascript
// ุนูุฏ ุชุณููู ุงูุชุญุงู ุงููุฑุงุฌุนุฉ
POST /api/exams/review/:reviewExamId/submit
```
**ูุง ูุญุฏุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
- โ **ุญูุธ ุงููุญุงููุฉ ุงูุฌุฏูุฏุฉ** ูู `attempts` array
- โ **ุชุญุฏูุซ ุนุฏุฏ ุงููุญุงููุงุช** `totalAttempts`
- โ **ุชุญุฏูุซ ุฃูุถู ูุชูุฌุฉ** ุฅุฐุง ูุงูุช ุฃูุถู ูู ุงูุณุงุจูุฉ
- โ **ุญูุธ ุฌููุน ุงูุฅุฌุงุจุงุช** ูุน ุงูุชูููุช

## ๐๏ธ **ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**

### **ูุฌููุนุฉ Users (ุงูุทูุงุจ):**
```javascript
{
  _id: ObjectId,
  name: "ุงุณู ุงูุทุงูุจ",
  email: "email@example.com",
  role: "student",
  examProgress: [
    {
      examId: ObjectId,
      status: "completed", // locked, unlocked, completed
      score: 8,
      percentage: 80,
      completedAt: Date,
      answers: [...],
      wrongQuestions: [ObjectId, ObjectId], // ุงูุฃุณุฆูุฉ ุงูุฎุงุทุฆุฉ
      reviewExamId: ObjectId // ุฑุงุจุท ูุงูุชุญุงู ุงููุฑุงุฌุนุฉ
    }
  ],
  totalScore: 25,
  overallPercentage: 75
}
```

### **ูุฌููุนุฉ Exams (ุงูุงูุชุญุงูุงุช):**
```javascript
{
  _id: ObjectId,
  title: "ุงูุชุญุงู ุงูุฑูุงุถูุงุช",
  examGroup: 1,
  order: 1,
  timeLimit: 120,
  questions: [
    {
      _id: ObjectId,
      questionImage: "image.jpg",
      options: ["A", "B", "C", "D"],
      correctAnswer: "A",
      explanation: "ุดุฑุญ ุงูุฅุฌุงุจุฉ"
    }
  ],
  statistics: {
    totalAttempts: 15,
    passRate: 12,
    averageScore: 75.5
  }
}
```

### **ูุฌููุนุฉ ReviewExams (ุงูุชุญุงูุงุช ุงููุฑุงุฌุนุฉ):**
```javascript
{
  _id: ObjectId,
  studentId: ObjectId,
  originalExamId: ObjectId,
  title: "ุงูุชุญุงู ูุฑุงุฌุนุฉ - ุงูุชุญุงู ุงูุฑูุงุถูุงุช",
  questions: [
    {
      questionId: ObjectId,
      originalQuestionIndex: 2
    }
  ],
  timeLimit: 30,
  attempts: [
    {
      attemptNumber: 1,
      answers: [...],
      score: 3,
      percentage: 75,
      completedAt: Date
    }
  ],
  bestScore: 3,
  bestPercentage: 75,
  totalAttempts: 1
}
```

## ๐ **ูุซุงู ุนูู ุงูุชุฏูู ุงููุงูู:**

### **ุงูุณููุงุฑูู: ูุนูู ูุถูู ุงูุชุญุงู ุฌุฏูุฏ**

1. **ุงููุนูู ููุดุฆ ุงูุชุญุงู:**
   ```javascript
   POST /api/exams
   {
     title: "ุงูุชุญุงู ุงูุฌุจุฑ",
     examGroup: 2,
     order: 1,
     questions: [...]
   }
   ```

2. **ูุง ูุญุฏุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
   ```javascript
   // 1. ุญูุธ ุงูุงูุชุญุงู
   exams.insertOne({
     title: "ุงูุชุญุงู ุงูุฌุจุฑ",
     examGroup: 2,
     order: 1,
     questions: [...],
     statistics: { totalAttempts: 0, passRate: 0, averageScore: 0 }
   })

   // 2. ุชุญุฏูุซ ุฌููุน ุงูุทูุงุจ
   students.updateMany(
     { role: "student" },
     { $push: { 
       examProgress: {
         examId: newExamId,
         status: "locked",
         score: 0,
         percentage: 0
       }
     }}
   )
   ```

### **ุงูุณููุงุฑูู: ุทุงูุจ ูุญู ุงูุงูุชุญุงู**

1. **ุงูุทุงูุจ ูุณูู ุงูุงูุชุญุงู:**
   ```javascript
   POST /api/exams/examId/submit
   {
     answers: [
       { selectedAnswer: "A" },
       { selectedAnswer: "B" },
       { selectedAnswer: "C" }
     ]
   }
   ```

2. **ูุง ูุญุฏุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
   ```javascript
   // 1. ุชุญุฏูุซ ุชูุฏู ุงูุทุงูุจ
   students.updateOne(
     { _id: studentId, "examProgress.examId": examId },
     { $set: {
       "examProgress.$.status": "completed",
       "examProgress.$.score": 2,
       "examProgress.$.percentage": 66.7,
       "examProgress.$.completedAt": new Date(),
       "examProgress.$.answers": [...],
       "examProgress.$.wrongQuestions": [questionId3]
     }}
   )

   // 2. ุฅูุดุงุก ุงูุชุญุงู ูุฑุงุฌุนุฉ (ุฅุฐุง ูุงู ููุงู ุฃุณุฆูุฉ ุฎุงุทุฆุฉ)
   reviewExams.insertOne({
     studentId: studentId,
     originalExamId: examId,
     title: "ุงูุชุญุงู ูุฑุงุฌุนุฉ - ุงูุชุญุงู ุงูุฌุจุฑ",
     questions: [{ questionId: questionId3, originalQuestionIndex: 2 }],
     timeLimit: 15,
     attempts: [],
     bestScore: 0,
     bestPercentage: 0,
     totalAttempts: 0
   })

   // 3. ุฑุจุท ุงูุชุญุงู ุงููุฑุงุฌุนุฉ ุจุงูุทุงูุจ
   students.updateOne(
     { _id: studentId, "examProgress.examId": examId },
     { $set: { "examProgress.$.reviewExamId": reviewExamId } }
   )

   // 4. ูุชุญ ุงูุงูุชุญุงู ุงูุชุงูู
   students.updateOne(
     { _id: studentId, "examProgress.examId": nextExamId },
     { $set: { "examProgress.$.status": "unlocked" } }
   )
   ```

## ๐ฏ **ุงูุฎูุงุตุฉ:**

### โ **ุฌููุน ุงูุนูููุงุช ุชุชู ุชููุงุฆูุงู:**
- **ุฅุถุงูุฉ ุงูุชุญุงู** โ ุชุญุฏูุซ ุฌููุน ุงูุทูุงุจ
- **ุญุฐู ุงูุชุญุงู** โ ุฅุฒุงูุฉ ูู ุฌููุน ุงูุทูุงุจ
- **ุญู ุงูุชุญุงู** โ ุญูุธ ุงููุชุงุฆุฌ + ุฅูุดุงุก ูุฑุงุฌุนุฉ + ูุชุญ ุงูุชุงูู
- **ุญู ูุฑุงุฌุนุฉ** โ ุญูุธ ุงููุญุงููุฉ + ุชุญุฏูุซ ุฃูุถู ูุชูุฌุฉ

### ๐ **ุถูุงูุงุช ุงูุฃูุงู:**
- **ูุนุงููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช** - ุฅูุง ุชูุฌุญ ูููุง ุฃู ุชูุดู ูููุง
- **ุงูุชุญูู ูู ุงูุตูุงุญูุงุช** - ูู ุทุงูุจ ูุฑู ููุท ุจูุงูุงุชู
- **ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช** - ูุจู ุงูุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ๐ **ุงูุชุชุจุน ุงูุดุงูู:**
- **ุชุงุฑูุฎ ูุงูู** ูุฌููุน ุงูุนูููุงุช
- **ุฅุญุตุงุฆูุงุช ููุตูุฉ** ููู ุงูุชุญุงู
- **ุชูุฏู ูุฑุฏู** ููู ุทุงูุจ
- **ูุญุงููุงุช ูุชุนุฏุฏุฉ** ูุงูุชุญุงูุงุช ุงููุฑุงุฌุนุฉ

**ุงููุธุงู ูุตูู ูุถูุงู ูุฒุงููุฉ ูุงููุฉ ูููุซููุฉ ูุฌููุน ุงูุจูุงูุงุช! ๐**
